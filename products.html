<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prodotti - Cronoshop</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Animated Background -->
    <div class="animated-background"></div>
    
    <!-- Header -->
    <header class="glass-header">
        <nav class="nav-container">
            <div class="logo">
                <h1><a href="index.html" style="text-decoration: none; color: inherit;">üõçÔ∏è Cronoshop</a></h1>
            </div>
            <div class="nav-menu" id="navMenu">
                <a href="index.html" class="nav-link">Home</a>
                <a href="index.html#offerte" class="nav-link">Offerte</a>
                <a href="products.html" class="nav-link active">Prodotti</a>
                <a href="categorie.html" class="nav-link">Categorie</a>
                <a href="wishlist.html" class="nav-link">Wishlist</a>
                <a href="account.html" class="nav-link">Profilo</a>
                <a href="chisiamo.html" class="nav-link">Chi Siamo</a>
                <a href="blog.html" class="nav-link">Blog</a>
                <a href="faq.html" class="nav-link">FAQ</a>
            </div>
            <div class="nav-actions">
                <button class="glass-btn search-btn">üîç</button>
                <a href="cart.html" class="glass-btn cart-btn">üõí <span class="cart-count">0</span></a>
                <button class="glass-btn theme-btn">üåô</button>
                <button class="glass-btn mobile-menu-btn">‚ò∞</button>
            </div>
        </nav>
        
        <!-- Search Bar -->
        <div class="search-container" id="searchContainer">
            <div class="glass-search">
                <input type="text" placeholder="Cerca prodotti..." id="searchInput">
                <button>Cerca</button>
            </div>
        </div>
    </header>

    <!-- Products Section -->
    <section class="products-section" style="padding-top: 120px;">
        <div class="section-header">
            <h2>üõçÔ∏è Tutti i Prodotti</h2>
            <p style="color: var(--text-secondary); margin-bottom: 2rem;">Scopri la nostra collezione completa di prodotti selezionati</p>
            
            <!-- Filter and Sort Controls -->
            <div class="products-controls" style="margin-bottom: 2rem;">
                <div class="filter-buttons">
                    <button class="glass-btn filter-btn active" data-category="all">Tutti</button>
                    <button class="glass-btn filter-btn" data-category="smartphone">üì± Smartphone</button>
                    <button class="glass-btn filter-btn" data-category="fashion">üëï Fashion</button>
                    <button class="glass-btn filter-btn" data-category="casa">üè† Casa</button>
                    <button class="glass-btn filter-btn" data-category="tech">üíª Tech</button>
                    <button class="glass-btn filter-btn" data-category="salute">üíä Salute</button>
                </div>
                
                <div class="sort-controls" style="margin-top: 1rem;">
                    <select class="glass-input" id="sortSelect" style="width: auto; padding: 0.5rem 1rem;">
                        <option value="default">Ordina per</option>
                        <option value="price-low">Prezzo: dal pi√π basso</option>
                        <option value="price-high">Prezzo: dal pi√π alto</option>
                        <option value="name">Nome A-Z</option>
                        <option value="category">Categoria</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- Products Stats -->
        <div class="products-stats glass-card" style="margin-bottom: 2rem; padding: 1.5rem; text-align: center;">
            <div style="display: flex; justify-content: center; gap: 2rem; flex-wrap: wrap;">
                <div class="stat-item">
                    <span class="stat-number" id="totalProducts">0</span>
                    <span class="stat-label">Prodotti Totali</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="categoriesCount">5</span>
                    <span class="stat-label">Categorie</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="avgDiscount">25%</span>
                    <span class="stat-label">Sconto Medio</span>
                </div>
            </div>
        </div>
        
        <!-- Products Grid -->
        <div class="products-grid" id="productsGrid">
            <!-- Products will be loaded here by JavaScript -->
        </div>
        
        <!-- Load More Button -->
        <div class="load-more-container" style="margin-top: 3rem;">
            <button class="glass-btn load-more-btn" id="loadMoreBtn">
                Carica Altri Prodotti
            </button>
        </div>
    </section>

    <!-- Footer -->
    <footer class="glass-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Cronoshop</h4>
                <p>La tua piattaforma per le migliori offerte Amazon</p>
            </div>
            <div class="footer-section">
                <h4>Link Utili</h4>
                <a href="groups.html">Gruppi WhatsApp</a>
                <a href="categorie.html">Categorie</a>
                <a href="account.html">Account</a>
            </div>
            <div class="footer-section">
                <h4>Contatti</h4>
                <a href="groups.html">WhatsApp</a>
                <a href="#email">Email</a>
                <a href="#social">Social</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Cronoshop. Tutti i diritti riservati.</p>
        </div>
    </footer>

    <style>
        .products-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .sort-controls select {
            background: var(--glass-white);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-md);
            color: var(--text-primary);
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
        }

        .product-card {
            background: var(--glass-white);
            border-radius: var(--radius-lg);
            overflow: hidden;
            transition: all var(--transition-smooth);
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--glass-shadow-strong);
        }

        .product-image-container {
            position: relative;
            overflow: hidden;
        }

        .product-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: transform var(--transition-smooth);
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .product-info {
            padding: 1.5rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .product-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .product-price {
            margin-bottom: 1rem;
        }

        .current-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--success-green);
        }

        .original-price {
            font-size: 1rem;
            color: var(--text-secondary);
            text-decoration: line-through;
            margin-right: 0.5rem;
        }

        .discount-badge {
            background: var(--error-red);
            color: var(--text-white);
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius-sm);
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .product-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            flex: 1;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .product-actions {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: auto;
        }

        .buy-btn {
            width: 100%;
            padding: 1rem;
            font-weight: 700;
            font-size: 1rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            color: var(--text-white);
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .buy-btn:hover {
            background: linear-gradient(135deg, var(--accent-blue), var(--primary-blue));
            transform: translateY(-2px);
        }

        body.dark-mode .buy-btn {
            background: linear-gradient(135deg, var(--glass-white), var(--glass-white-strong));
            color: var(--text-primary);
        }

        body.dark-mode .buy-btn:hover {
            background: linear-gradient(135deg, var(--glass-white-strong), var(--glass-white));
        }

        .secondary-actions {
            display: flex;
            gap: 0.5rem;
        }

        .action-btn {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-md);
            background: var(--glass-white);
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .action-btn:hover {
            background: var(--glass-white-strong);
            border-color: var(--primary-blue);
            color: var(--text-blue);
            transform: translateY(-1px);
        }

        .action-btn.wishlist-btn:hover {
            color: var(--error-red);
            border-color: var(--error-red);
        }

        .action-btn.share-btn:hover {
            color: var(--success-green);
            border-color: var(--success-green);
        }

        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .products-controls {
                gap: 1.5rem;
            }
            
            .filter-buttons {
                flex-direction: column;
                width: 100%;
                max-width: 300px;
            }
            
            .filter-btn {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .product-info {
                padding: 1rem;
            }
            
            .secondary-actions {
                flex-direction: column;
            }
            
            .action-btn {
                width: 100%;
            }
        }
    </style>

    <script src="main.js"></script>
    <script>
        // Products page specific functionality
        let currentProducts = [];
        let displayedProducts = [];
        let currentPage = 0;
        const productsPerPage = 12;
        let currentFilter = 'all';
        let currentSort = 'default';

        // Initialize products page
        document.addEventListener('DOMContentLoaded', function() {
            initializeProductsPage();
        });

        function initializeProductsPage() {
            loadProductsData();
            setupProductsEventListeners();
            updateCartCount();
            updateProductsStats();
            renderProducts();
            
            // Load theme preference
            const darkMode = localStorage.getItem('darkMode') === 'true';
            if (darkMode) {
                document.body.classList.add('dark-mode');
                const themeBtn = document.querySelector('.theme-btn');
                if (themeBtn) {
                    themeBtn.textContent = '‚òÄÔ∏è';
                }
            }
        }

        function loadProductsData() {
            // Use the products array from main.js
            if (typeof products !== 'undefined') {
                currentProducts = [...products];
            } else {
                // Fallback if products array is not available
                currentProducts = [];
            }
        }

        function setupProductsEventListeners() {
            // Filter buttons
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const category = this.dataset.category;
                    filterProducts(category);
                    
                    filterButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // Sort dropdown
            const sortSelect = document.getElementById('sortSelect');
            if (sortSelect) {
                sortSelect.addEventListener('change', function() {
                    currentSort = this.value;
                    sortProducts();
                    renderProducts();
                });
            }

            // Search functionality
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', debounce(searchProducts, 300));
            }

            // Search button
            const searchBtn = document.querySelector('.search-btn');
            if (searchBtn) {
                searchBtn.addEventListener('click', toggleSearch);
            }

            // Theme button
            const themeBtn = document.querySelector('.theme-btn');
            if (themeBtn) {
                themeBtn.addEventListener('click', toggleTheme);
            }

            // Mobile menu toggle
            const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', toggleMobileMenu);
            }

            // Load more button
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            if (loadMoreBtn) {
                loadMoreBtn.addEventListener('click', loadMoreProducts);
            }
        }

        function filterProducts(category) {
            currentFilter = category;
            currentPage = 0;
            
            if (category === 'all') {
                currentProducts = [...products];
            } else {
                currentProducts = products.filter(product => product.category === category);
            }
            
            sortProducts();
            renderProducts();
            updateProductsStats();
            showNotification(`Filtro applicato: ${category === 'all' ? 'Tutti i prodotti' : category}`);
        }

        function sortProducts() {
            switch (currentSort) {
                case 'price-low':
                    currentProducts.sort((a, b) => {
                        const priceA = parseFloat(a.prezzo.replace('‚Ç¨', '').replace(',', '.'));
                        const priceB = parseFloat(b.prezzo.replace('‚Ç¨', '').replace(',', '.'));
                        return priceA - priceB;
                    });
                    break;
                case 'price-high':
                    currentProducts.sort((a, b) => {
                        const priceA = parseFloat(a.prezzo.replace('‚Ç¨', '').replace(',', '.'));
                        const priceB = parseFloat(b.prezzo.replace('‚Ç¨', '').replace(',', '.'));
                        return priceB - priceA;
                    });
                    break;
                case 'name':
                    currentProducts.sort((a, b) => a.nome.localeCompare(b.nome));
                    break;
                case 'category':
                    currentProducts.sort((a, b) => a.category.localeCompare(b.category));
                    break;
                default:
                    // Keep original order
                    break;
            }
        }

        function searchProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            
            if (searchTerm === '') {
                if (currentFilter === 'all') {
                    currentProducts = [...products];
                } else {
                    currentProducts = products.filter(product => product.category === currentFilter);
                }
            } else {
                let baseProducts = currentFilter === 'all' ? products : products.filter(product => product.category === currentFilter);
                currentProducts = baseProducts.filter(product =>
                    product.nome.toLowerCase().includes(searchTerm) ||
                    product.descrizione.toLowerCase().includes(searchTerm)
                );
            }
            
            currentPage = 0;
            sortProducts();
            renderProducts();
            updateProductsStats();
            showNotification(`Trovati ${currentProducts.length} prodotti`);
        }

        function renderProducts() {
            const grid = document.getElementById('productsGrid');
            if (!grid) return;

            const startIndex = currentPage * productsPerPage;
            const endIndex = startIndex + productsPerPage;
            const productsToShow = currentProducts.slice(startIndex, endIndex);
            
            if (currentPage === 0) {
                grid.innerHTML = '';
                displayedProducts = [];
            }

            productsToShow.forEach((product, index) => {
                const productCard = createProductCard(product);
                grid.appendChild(productCard);
                displayedProducts.push(product);
                
                setTimeout(() => {
                    productCard.classList.add('fade-in');
                }, index * 50);
            });

            // Update load more button
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            if (loadMoreBtn) {
                const hasMore = endIndex < currentProducts.length;
                loadMoreBtn.style.display = hasMore ? 'block' : 'none';
            }
        }

        function createProductCard(product) {
            const card = document.createElement('div');
            card.className = 'glass-card product-card';
            card.setAttribute('data-category', product.category);
            
            // Format price display
            let priceHTML = `<span class="current-price">${product.prezzo}</span>`;
            if (product.originalPrice && product.discount) {
                priceHTML = `
                    <span class="original-price">${product.originalPrice}</span>
                    <span class="current-price">${product.prezzo}</span>
                    <span class="discount-badge">${product.discount}</span>
                `;
            }

            card.innerHTML = `
                <div class="product-image-container">
                    <img src="${product.img}" alt="${product.nome}" class="product-image" loading="lazy">
                </div>
                <div class="product-info">
                    <h3 class="product-name">${product.nome}</h3>
                    <div class="product-price">${priceHTML}</div>
                    <p class="product-description">${product.descrizione}</p>
                    <div class="product-actions">
                        <button class="buy-btn" data-id="${product.id}">
                            üõí Acquista su Amazon
                        </button>
                        <div class="secondary-actions">
                            <button class="action-btn wishlist-btn" data-id="${product.id}">
                                ‚ù§Ô∏è Wishlist
                            </button>
                            <button class="action-btn cart-btn" data-id="${product.id}">
                                üõçÔ∏è Carrello
                            </button>
                            <button class="action-btn share-btn" data-id="${product.id}">
                                üì§ Condividi
                            </button>
                        </div>
                    </div>
                </div>
            `;

            // Add event listeners
            const buyBtn = card.querySelector('.buy-btn');
            const wishlistBtn = card.querySelector('.wishlist-btn');
            const cartBtn = card.querySelector('.cart-btn');
            const shareBtn = card.querySelector('.share-btn');

            if (buyBtn) {
                buyBtn.addEventListener('click', () => buyProduct(product.link));
            }
            if (wishlistBtn) {
                wishlistBtn.addEventListener('click', () => addToWishlist(product.id));
            }
            if (cartBtn) {
                cartBtn.addEventListener('click', () => addToCart(product.id));
            }
            if (shareBtn) {
                shareBtn.addEventListener('click', () => shareProduct(product));
            }

            return card;
        }

        function updateProductsStats() {
            const totalProducts = document.getElementById('totalProducts');
            if (totalProducts) {
                totalProducts.textContent = currentProducts.length;
            }
        }

        function loadMoreProducts() {
            currentPage++;
            renderProducts();
        }

        function shareProduct(product) {
            const shareText = `Guarda questa offerta su Cronoshop!\n\n${product.nome}\n${product.prezzo}\n\n${product.link}`;
            
            if (navigator.share) {
                navigator.share({
                    title: product.nome,
                    text: shareText,
                    url: product.link
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    showNotification('Link copiato negli appunti!');
                });
            }
        }

        // Utility functions (if not already defined in main.js)
        function toggleSearch() {
            const searchContainer = document.getElementById('searchContainer');
            if (searchContainer) {
                searchContainer.classList.toggle('active');
                if (searchContainer.classList.contains('active')) {
                    document.getElementById('searchInput').focus();
                }
            }
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDark);
            
            const themeBtn = document.querySelector('.theme-btn');
            if (themeBtn) {
                themeBtn.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
            }
            
            showNotification(`Tema ${isDark ? 'scuro' : 'chiaro'} attivato`);
        }

        function toggleMobileMenu() {
            const navMenu = document.getElementById('navMenu');
            if (navMenu) {
                navMenu.classList.toggle('active');
            }
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
    </script>
</body>
</html>
